<back></back>
<ngb-alert
  [type]="alert.type"
  [ngClass]="{ 'slide-in': showAlert, 'slide-out': !showAlert }"
  [dismissible]="false"
  *ngIf="showAlert"
>
  {{ alert.message }}
</ngb-alert>
<div class="applications container">
  <h2 class="text-center mt-3 mb-5">Blocked Accounts</h2>
  <h2 class="text-center my-5" *ngIf="blockedAccounts.length === 0">
    No Accounts...!
  </h2>
  <div class="applicationContent" *ngIf="blockedAccounts.length > 0">
    <div class="search-container mb-4">
      <input
        type="text"
        placeholder="Search by accountNumber"
        [(ngModel)]="searchTerm"
        class="search-box"
      />
    </div>

    <table class="table table-striped table-custom">
      <thead>
        <tr>
          <th class="text-left">Account ID</th>
          <th class="text-center">Account Number</th>
          <th class="text-right">Account Type</th>
          <th class="text-center">Branch Ifsc</th>
          <th class="text-center">Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr
          class="row-hover"
          *ngFor="
            let account of filteredAccounts
              | paginate
                : { itemsPerPage: itemsPerPage, currentPage: currentPage }
          "
        >
          <td class="text-left">{{ account.accountId }}</td>
          <td class="text-center">{{ account.accountNumber }}</td>
          <td class="text-right">{{ account.accountType }}</td>
          <td class="text-center">{{ account.branch.ifsc }}</td>
          <td class="text-center">
            <button
              class="btn btn-success btn-sm mx-2"
              (click)="ublockAccount(account.accountNumber)"
            >
              Unblock
            </button>
            <button
              class="btn btn-info btn-sm mx-2"
              (click)="moreInfo(account.accountId, content)"
            >
              Info
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <pagination-controls
      (pageChange)="currentPage = $event"
    ></pagination-controls>
  </div>
</div>

<ng-template #content let-modal>
  <div class="modal-header">
    <h4 class="modal-title">Application Details</h4>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="modal.dismiss('Cross click')"
    ></button>
  </div>
  <div class="modal-body">
    <p><strong>Account ID:</strong> {{ info?.accountId }}</p>
    <p><strong>Account Number:</strong> {{ info?.accountNumber }}</p>
    <p><strong>C-ID:</strong> {{ info?.customer?.customerId }}</p>
    <p><strong>Account Type:</strong> {{ info?.accountType }}</p>
    <p><strong>C-Name:</strong> {{ info?.customer?.name }}</p>
    <p>
      <strong>Branch:</strong>
      {{ info?.branch?.address?.buildingName }},&nbsp;
      {{ info?.branch?.address?.street }},&nbsp;
      {{ info?.branch?.address?.city }},&nbsp;{{
        info?.branch?.address?.state
      }},&nbsp;{{ info?.branch?.address?.zipcode }}
    </p>
    <p><strong>Branch IFSC:</strong> {{ info?.branch?.ifsc }}</p>
    <p><strong>Balance:</strong> {{ info?.balance }}</p>
    <p><strong>Account status:</strong> {{ info?.accountStatus }}</p>
  </div>
</ng-template>
